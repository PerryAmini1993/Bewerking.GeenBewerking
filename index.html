<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monthly Data Analysis</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            color: #2c3e50;
            font-size: 2.5em;
            margin-bottom: 10px;
            font-weight: 300;
        }

        .header p {
            color: #7f8c8d;
            font-size: 1.2em;
            margin: 0;
        }

        .controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-bottom: 40px;
            flex-wrap: wrap;
        }

        .month-selector {
            padding: 12px 20px;
            border: 2px solid #3498db;
            border-radius: 8px;
            background: white;
            font-size: 16px;
            font-weight: 500;
            color: #2c3e50;
            cursor: pointer;
            min-width: 150px;
        }

        .month-selector:focus {
            outline: none;
            box-shadow: 0 0 10px rgba(52, 152, 219, 0.3);
        }

        .print-button {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
            transition: all 0.3s ease;
        }

        .print-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }

        .current-month {
            text-align: center;
            margin-bottom: 30px;
        }

        .current-month h2 {
            color: #2c3e50;
            font-size: 2.2em;
            margin: 0;
            font-weight: 400;
        }

        .year-section {
            margin-bottom: 50px;
        }

        .year-title {
            text-align: center;
            color: #2c3e50;
            font-size: 2em;
            margin-bottom: 30px;
            font-weight: 400;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }

        .charts-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-bottom: 30px;
        }

        .chart-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .chart-container:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.15);
        }

        .chart-title {
            text-align: center;
            margin-bottom: 20px;
            color: #2c3e50;
            font-size: 1.4em;
            font-weight: 500;
        }

        .chart-wrapper {
            position: relative;
            height: 300px;
        }

        .stats-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-radius: 10px;
            border-left: 4px solid #3498db;
        }

        .stat-value {
            font-size: 1.8em;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #7f8c8d;
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .analysis-section {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            margin-top: 40px;
        }

        .analysis-title {
            text-align: center;
            color: #2c3e50;
            font-size: 1.8em;
            margin-bottom: 25px;
            font-weight: 400;
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }

        .analysis-item {
            padding: 20px;
            border-radius: 12px;
            border-left: 5px solid;
        }

        .increase {
            background: linear-gradient(135deg, #d5f4e6, #c8f7c5);
            border-left-color: #27ae60;
        }

        .decrease {
            background: linear-gradient(135deg, #fadbd8, #f5b7b1);
            border-left-color: #e74c3c;
        }

        .analysis-item h4 {
            margin: 0 0 10px 0;
            font-size: 1.2em;
        }

        .analysis-item ul {
            margin: 0;
            padding-left: 20px;
            color: #2c3e50;
        }

        @media print {
            .print-button, .controls {
                display: none;
            }

            body {
                background: white;
                margin: 0;
                padding: 0;
            }

            .container {
                background: white;
                box-shadow: none;
                margin: 0;
                padding: 20px;
                max-width: none;
            }

            .year-section {
                page-break-inside: avoid;
                margin-bottom: 30px;
            }

            .charts-grid {
                gap: 20px;
            }

            .chart-container {
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                page-break-inside: avoid;
            }

            .stats-container {
                box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
                page-break-inside: avoid;
            }
        }

        @media (max-width: 768px) {
            .charts-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .container {
                padding: 20px;
                margin: 10px;
            }

            .header h1 {
                font-size: 2em;
            }

            .controls {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Monthly Data Analysis</h1>
            <p>Year-over-Year Comparison of Orders with and without Bewerking</p>
        </div>

        <div class="controls">
            <select id="monthSelector" class="month-selector">
                <option value="december">December</option>
                <option value="november">November</option>
                <option value="october" selected>October</option>
                <option value="september">September</option>
                <option value="august">August</option>
                <option value="july">July</option>
                <option value="june">June</option>
                <option value="may">May</option>
                <option value="april">April</option>
            </select>
            <button class="print-button" onclick="window.print()">üñ®Ô∏è Print A4</button>
        </div>

        <div class="current-month">
            <h2 id="currentMonthTitle">October Comparison</h2>
        </div>

        <!-- 2025 Section -->
        <div class="year-section">
            <h3 class="year-title" id="year2025Title">October 2025</h3>

            <div class="charts-grid">
                <div class="chart-container">
                    <div class="chart-title">Count Distribution</div>
                    <div class="chart-wrapper">
                        <canvas id="countChart2025"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">Weight Distribution</div>
                    <div class="chart-wrapper">
                        <canvas id="weightChart2025"></canvas>
                    </div>
                </div>
            </div>

            <div class="stats-container">
                <div class="stats-grid" id="statsGrid2025"></div>
            </div>
        </div>

        <!-- 2024 Section -->
        <div class="year-section">
            <h3 class="year-title" id="year2024Title">October 2024</h3>

            <div class="charts-grid">
                <div class="chart-container">
                    <div class="chart-title">Count Distribution</div>
                    <div class="chart-wrapper">
                        <canvas id="countChart2024"></canvas>
                    </div>
                </div>

                <div class="chart-container">
                    <div class="chart-title">Weight Distribution</div>
                    <div class="chart-wrapper">
                        <canvas id="weightChart2024"></canvas>
                    </div>
                </div>
            </div>

            <div class="stats-container">
                <div class="stats-grid" id="statsGrid2024"></div>
            </div>
        </div>

        <!-- Analysis Section -->
        <div class="analysis-section">
            <h3 class="analysis-title" id="analysisTitle">October Year-over-Year Analysis</h3>
            <div id="analysisContent"></div>
        </div>
    </div>

    <script>
        const monthData = {
            december: {
                name: 'December',
                2025: {
                    totalCount: 99,
                    totalWeight: 869628,
                    bewerkingCount: 43,
                    bewerkingWeight: 270390,
                    colors: ['#3498db', '#e74c3c']
                },
                2024: {
                    totalCount: 110,
                    totalWeight: 1119317,
                    bewerkingCount: 39,
                    bewerkingWeight: 281777,
                    colors: ['#27ae60', '#f39c12']
                }
            },
            november: {
                name: 'November',
                2025: {
                    totalCount: 135,
                    totalWeight: 1760161,
                    bewerkingCount: 47,
                    bewerkingWeight: 395059,
                    colors: ['#3498db', '#e74c3c']
                },
                2024: {
                    totalCount: 145,
                    totalWeight: 1913793,
                    bewerkingCount: 38,
                    bewerkingWeight: 411509,
                    colors: ['#27ae60', '#f39c12']
                }
            },
            october: {
                name: 'October',
                2025: {
                    totalCount: 194,
                    totalWeight: 2849823,
                    bewerkingCount: 70,
                    bewerkingWeight: 1047257,
                    colors: ['#3498db', '#e74c3c']
                },
                2024: {
                    totalCount: 179,
                    totalWeight: 2126917,
                    bewerkingCount: 72,
                    bewerkingWeight: 791963,
                    colors: ['#27ae60', '#f39c12']
                }
            },
            september: {
                name: 'September',
                2025: {
                    totalCount: 176,
                    totalWeight: 2454907,
                    bewerkingCount: 60,
                    bewerkingWeight: 640598,
                    colors: ['#3498db', '#e74c3c']
                },
                2024: {
                    totalCount: 172,
                    totalWeight: 1657041,
                    bewerkingCount: 67,
                    bewerkingWeight: 436158,
                    colors: ['#27ae60', '#f39c12']
                }
            },
            august: {
                name: 'August',
                2025: {
                    totalCount: 117,
                    totalWeight: 1436095,
                    bewerkingCount: 38,
                    bewerkingWeight: 238877,
                    colors: ['#3498db', '#e74c3c']
                },
                2024: {
                    totalCount: 99,
                    totalWeight: 1265074,
                    bewerkingCount: 21,
                    bewerkingWeight: 184206,
                    colors: ['#27ae60', '#f39c12']
                }
            },
            july: {
                name: 'July',
                2025: {
                    totalCount: 159,
                    totalWeight: 1923068,
                    bewerkingCount: 57,
                    bewerkingWeight: 561772,
                    colors: ['#3498db', '#e74c3c']
                },
                2024: {
                    totalCount: 135,
                    totalWeight: 2126580,
                    bewerkingCount: 47,
                    bewerkingWeight: 459593,
                    colors: ['#27ae60', '#f39c12']
                }
            },
            june: {
                name: 'June',
                2025: {
                    totalCount: 195,
                    totalWeight: 1889608,
                    bewerkingCount: 87,
                    bewerkingWeight: 555420,
                    colors: ['#3498db', '#e74c3c']
                },
                2024: {
                    totalCount: 150,
                    totalWeight: 1738028,
                    bewerkingCount: 37,
                    bewerkingWeight: 373680,
                    colors: ['#27ae60', '#f39c12']
                }
            },
            may: {
                name: 'May',
                2025: {
                    totalCount: 154,
                    totalWeight: 1830837,
                    bewerkingCount: 47,
                    bewerkingWeight: 388645,
                    colors: ['#3498db', '#e74c3c']
                },
                2024: {
                    totalCount: 200,
                    totalWeight: 1489000,
                    bewerkingCount: 60,
                    bewerkingWeight: 582410,
                    colors: ['#27ae60', '#f39c12']
                }
            },
            april: {
                name: 'April',
                2025: {
                    totalCount: 191,
                    totalWeight: 2969823,
                    bewerkingCount: 73,
                    bewerkingWeight: 1134472,
                    colors: ['#3498db', '#e74c3c']
                },
                2024: {
                    totalCount: 173,
                    totalWeight: 2029616,
                    bewerkingCount: 68,
                    bewerkingWeight: 797639,
                    colors: ['#27ae60', '#f39c12']
                }
            }
        };

        let charts = {};

        const chartOptions = {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: {
                        padding: 20,
                        font: {
                            size: 12
                        }
                    }
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            const label = context.label || '';
                            const value = context.parsed;
                            const total = context.dataset.data.reduce((a, b) => a + b, 0);
                            const percentage = ((value / total) * 100).toFixed(1);

                            const canvasId = context.chart.canvas.id;
                            if (canvasId.includes('weight')) {
                                return `${label}: ${value.toLocaleString()} kg (${percentage}%)`;
                            } else {
                                return `${label}: ${value.toLocaleString()} (${percentage}%)`;
                            }
                        }
                    }
                }
            }
        };

        function createChart(canvasId, data, isWeight = false) {
            const ctx = document.getElementById(canvasId).getContext('2d');
            if (charts[canvasId]) {
                charts[canvasId].destroy();
            }

            const noBewerkingValue = isWeight ?
                data.totalWeight - data.bewerkingWeight :
                data.totalCount - data.bewerkingCount;

            const chartData = isWeight ?
                [data.bewerkingWeight, noBewerkingValue] :
                [data.bewerkingCount, noBewerkingValue];

            charts[canvasId] = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['With Bewerking', 'Without Bewerking'],
                    datasets: [{
                        data: chartData,
                        backgroundColor: data.colors,
                        hoverBackgroundColor: data.colors.map(color => {
                            return color === '#3498db' ? '#2980b9' :
                                   color === '#e74c3c' ? '#c0392b' :
                                   color === '#27ae60' ? '#229954' :
                                   color === '#f39c12' ? '#e67e22' : color;
                        }),
                        borderWidth: 3,
                        borderColor: '#fff'
                    }]
                },
                options: chartOptions
            });
        }

        function updateStats(gridId, data) {
            const noBewerkingCount = data.totalCount - data.bewerkingCount;
            const noBewerkingWeight = data.totalWeight - data.bewerkingWeight;

            document.getElementById(gridId).innerHTML = `
                <div class="stat-item">
                    <div class="stat-value">${data.totalCount}</div>
                    <div class="stat-label">Total Orders</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">${data.totalWeight.toLocaleString()}</div>
                    <div class="stat-label">Total Weight (kg)</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">${data.bewerkingCount}</div>
                    <div class="stat-label">Orders with Bewerking</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">${noBewerkingCount}</div>
                    <div class="stat-label">Orders without Bewerking</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">${data.bewerkingWeight.toLocaleString()}</div>
                    <div class="stat-label">Total Weight with Bewerking (kg)</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">${noBewerkingWeight.toLocaleString()}</div>
                    <div class="stat-label">Total Weight without Bewerking (kg)</div>
                </div>
            `;
        }

        function generateAnalysis(monthData) {
            const data2025 = monthData[2025];
            const data2024 = monthData[2024];

            const totalOrdersChange = data2025.totalCount - data2024.totalCount;
            const totalWeightChange = data2025.totalWeight - data2024.totalWeight;
            const bewerkingOrdersChange = data2025.bewerkingCount - data2024.bewerkingCount;
            const bewerkingWeightChange = data2025.bewerkingWeight - data2024.bewerkingWeight;

            const totalOrdersPercent = ((totalOrdersChange / data2024.totalCount) * 100).toFixed(1);
            const totalWeightPercent = ((totalWeightChange / data2024.totalWeight) * 100).toFixed(1);
            const bewerkingOrdersPercent = ((bewerkingOrdersChange / data2024.bewerkingCount) * 100).toFixed(1);
            const bewerkingWeightPercent = ((bewerkingWeightChange / data2024.bewerkingWeight) * 100).toFixed(1);

            return `
                <div class="analysis-grid">
                    <div class="analysis-item ${totalOrdersChange >= 0 ? 'increase' : 'decrease'}">
                        <h4 style="color: ${totalOrdersChange >= 0 ? '#27ae60' : '#e74c3c'};">
                            üìà ${totalOrdersChange >= 0 ? 'INCREASES' : 'DECREASES'}
                        </h4>
                        <ul>
                            <li><strong>Total Orders:</strong> ${totalOrdersChange >= 0 ? '+' : ''}${totalOrdersChange} orders (${totalOrdersPercent >= 0 ? '+' : ''}${totalOrdersPercent}%)</li>
                            <li><strong>Total Weight:</strong> ${totalWeightChange >= 0 ? '+' : ''}${totalWeightChange.toLocaleString()} kg (${totalWeightPercent >= 0 ? '+' : ''}${totalWeightPercent}%)</li>
                            <li><strong>Orders with Bewerking:</strong> ${bewerkingOrdersChange >= 0 ? '+' : ''}${bewerkingOrdersChange} orders (${bewerkingOrdersPercent >= 0 ? '+' : ''}${bewerkingOrdersPercent}%)</li>
                            <li><strong>Weight with Bewerking:</strong> ${bewerkingWeightChange >= 0 ? '+' : ''}${bewerkingWeightChange.toLocaleString()} kg (${bewerkingWeightPercent >= 0 ? '+' : ''}${bewerkingWeightPercent}%)</li>
                        </ul>
                    </div>

                    <div class="analysis-item" style="background: linear-gradient(135deg, #f8f9fa, #e9ecef); border-left: 5px solid #6c757d; padding: 25px; border-radius: 12px;">
                        <h4 style="color: #495057; margin: 0 0 15px 0; font-size: 1.3em;">üí° KEY INSIGHTS</h4>
                        <div style="color: #2c3e50; line-height: 1.6;">
                            <p style="margin: 0 0 10px 0;">‚Ä¢ <strong>Processing Activity:</strong> Orders requiring bewerking changed from ${data2024.bewerkingCount} to ${data2025.bewerkingCount} orders.</p>
                            <p style="margin: 0 0 10px 0;">‚Ä¢ <strong>Overall Volume:</strong> Total orders changed from ${data2024.totalCount} to ${data2025.totalCount} orders and from ${data2024.totalWeight.toLocaleString()} kg to ${data2025.totalWeight.toLocaleString()} kg.</p>
                            <p style="margin: 0;">‚Ä¢ <strong>Weight Distribution:</strong> Bewerking orders represented ${data2024.bewerkingWeight.toLocaleString()} kg in 2024 and ${data2025.bewerkingWeight.toLocaleString()} kg in 2025.</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function updateMonth(monthKey) {
            const data = monthData[monthKey];
            const monthName = data.name;

            document.getElementById('currentMonthTitle').textContent = `${monthName} Comparison`;
            document.getElementById('year2025Title').textContent = `${monthName} 2025`;
            document.getElementById('year2024Title').textContent = `${monthName} 2024`;
            document.getElementById('analysisTitle').textContent = `${monthName} Year-over-Year Analysis`;

            createChart('countChart2025', data[2025]);
            createChart('weightChart2025', data[2025], true);
            createChart('countChart2024', data[2024]);
            createChart('weightChart2024', data[2024], true);

            updateStats('statsGrid2025', data[2025]);
            updateStats('statsGrid2024', data[2024]);

            document.getElementById('analysisContent').innerHTML = generateAnalysis(data);
        }

        updateMonth('october');

        document.getElementById('monthSelector').addEventListener('change', function(e) {
            updateMonth(e.target.value);
        });
    </script>
</body>
</html>
